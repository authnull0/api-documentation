
# AD Agent

The AD (Active Directory) agent is a software component that is designed to integrate with an Active Directory environment and facilitate the synchronization of user and group information between Active Directory and Authnull Active Directory Proxy Server.
The AD agent is responsible for pulling user and group information from the Active Directory and pushing it to an authentication and authorization (authnull) AD proxy server. This process is commonly known as identity synchronization or user/group synchronization.

### Daemon
The daemon is the program that runs continuously in the background to synchronize user and group information to the AD proxy. The daemon may be designed to run on a dedicated server or workstation and can be configured to perform periodic checks or real-time synchronization between the source system (such as Active Directory) and the target system (such as the AD proxy).

## Configuration File
1. The windows server of 2012 and above is needed.

2. You need access to window server to install okta Active Directory agent.

3.The agent host server must be a member of the same windows domain as your active directory.

4. The windows server where the agent reside must be on at all time.

## Save ActiveDirectory Configuration

```shell
curl POST "https://api.authnull.kloudlearn.com/api/v1/saveActiveDirectoryConfig"
```

```HTTP
POST api/v1/saveActiveDirectoryConfig HTTP/1.1
```

```json
[
 {
    "directoryName":"xyz-xyz-xyz", 
    "accountName":"abc-abc-abc", 
    "appUrl":"www.kloudlearn.com", 
    "domainId":"1"
}
]
```

Active Directory is a directory service or container which stores data objects on your local network environment. The service records data on users, devices, applications, groups, and devices in a hierarchical structure.
Active Directory enables users to log on to and manage a variety of resources from one location. Login credentials are unified so that it is easier to manage multiple devices without having to enter account details to access each individual machine.

### Access Token
Authorization Key Required 


### HTTP Request

`POST api/v1/saveActiveDirectoryConfig HTTP/1.1`

### Query Parameters

Parameter | Description
--------- | ------- | -----------
directoryName | Name of Directory.
appUrl | App URL is url for app.
accountName | Name of the Account.
domainId | This is the unique ID assigned by the registry to the domain. 

### HTTP response

` ActiveDirectory Configure successfully saved`


<aside class="success">
ActiveDirectory Configure successfully saved
</aside>

## Restart the Agent
 For Restart the agent what will happen is the installation will complete and all the api incluging the Active Directory will configure and import the group and the user to active directory of the AuthNull.

## Import Users

```shell
curl POST "https://api.authnull.kloudlearn.com/api/v1/importUsers"
```

```HTTP
POST api/v1/importUsers HTTP/1.1
```

```json
[
{
    "ldapHost":"ldap.forumsys.com",
    "ldapPort":"389",
    "baseDN":"dc=example,dc=com",
    "filter":"(ou=italians)",
    "bindDN":"BindDN",
    "domainID":"91"
}
]
```

This will Import Users.

### Access Token
Authorization Key Required 

### HTTP Request

`POST api/v1/importUsers HTTP/1.1`

### Query Parameters

Parameter | Description
--------- | ------- | -----------
ldapHost | LDAPHost.
ldapPort | LDAPPort.
baseDN | BaseDN.
filter | Filter. 
bindDN | BindDN. 
domainID | DomainID. 

### HTTP response

`successfully Imported Users`


<aside class="success">
successfully Imported Users
</aside>

## Get Import Status

```shell
curl  POST "https://api.authnull.kloudlearn.com/api/v1/getImportStatus" 
```

```HTTP
POST api/v1/getImportStatus HTTP/1.1
```

```json
[
{
    "DirectoryName":"ldap.forumsys.com"
}
]
```

This will Get Import Status.

### Access Token
Authorization Key Required 

### HTTP Request

`POST api/v1/getImportStatus HTTP/1.1`

### Query Parameters

Parameter | Description
--------- | ------- | -----------
directoryName | Name of the Directory.

### HTTP response

`Imported status successfully`


<aside class="success">
Imported status successfully
</aside>

## Mapping api 
For mapping api we need to reconfigure the api:

## Reconfigure Active Directory

```shell
curl POST "https://api.authnull.kloudlearn.com/api/v1/reConfigure" 
```

```HTTP
POST api/v1/reConfigure HTTP/1.1
```

```json
[
FieldMappings: {

email "john@kloudone.com",

slack: "JohnDoe",

username: "John",

department: "IT",

group: "groupA",

subgroup: "subgroupA",

roles: "admin",

location: "India",

region: "United States",

primaryApp: "kloudone",

fax: "1234567890"

}
]
```

This will reConfigure Active Directory.

### Access Token
Authorization Key Required 

### HTTP Request

`POST api/v1/reConfigure HTTP/1.1`

### Query Parameters

Parameter | Description
--------- | ------- | -----------
groupID | GrouId is the id of group.
fieldMappings | FieldMappings is the mapping of the field.

### HTTP response

`successfully reConfigured Active Directory`


<aside class="success">
successfully reConfigured Active Directory
</aside>